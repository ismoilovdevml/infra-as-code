---
- name: Boostratp Servers
  hosts: master,nodes
  become: yes
  vars_files:
    - vars.yml

  tasks:
    - name: Ensure required packages are installed
      package:
        name:
          - curl
          - wget
          - net-tools
          - git
          - "{{ java_packages[ansible_distribution] }}"
        state: present

    - name: Find Java 11 installation path
      command: "update-alternatives --list java"
      register: java_alternatives_output
      changed_when: false

    - name: Set default Java version to Java 11
      alternatives:
        name: java
        path: "{{ java_alternatives_output.stdout_lines | select('search', 'java-11') | list | first }}"
      when: java_alternatives_output.stdout_lines | select('search', 'java-11') | list | length > 0

    - name: Verify Java installation
      command: java -version
      register: java_version_output
      changed_when: false
      ignore_errors: true

    - name: Debug Java installation output
      debug:
        msg: "Java version output: {{ java_version_output.stdout }}"